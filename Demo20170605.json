{"paragraphs":[{"text":"%pyspark\n\ndata = [1,2,3,4,5]\nprint type(data)\n\nrDD = sc.parallelize(data, 4)\nprint type(rDD)\n\nprint rDD.collect()\n","dateUpdated":"Jun 5, 2017 5:39:49 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1496631815467_-1605588508","id":"20170605-030335_1709959895","result":{"code":"SUCCESS","type":"TEXT","msg":"<type 'list'>\n<class 'pyspark.rdd.RDD'>\n[1, 2, 3, 4, 5]\n"},"dateCreated":"Jun 5, 2017 3:03:35 AM","dateStarted":"Jun 5, 2017 5:39:49 AM","dateFinished":"Jun 5, 2017 5:39:49 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2385","focus":true},{"text":"%sh ls /tmp/install.log","dateUpdated":"Jun 5, 2017 3:42:22 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1496631947725_-1498812204","id":"20170605-030547_1944014741","result":{"code":"SUCCESS","type":"TEXT","msg":"/tmp/install.log\n"},"dateCreated":"Jun 5, 2017 3:05:47 AM","dateStarted":"Jun 5, 2017 3:42:22 AM","dateFinished":"Jun 5, 2017 3:42:22 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2386"},{"text":"%pyspark\n\nlines = sc.textFile('file:///tmp/install.log')\n#print lines.collect()","dateUpdated":"Jun 5, 2017 3:44:45 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1496634173055_87477386","id":"20170605-034253_1956798605","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"Jun 5, 2017 3:42:53 AM","dateStarted":"Jun 5, 2017 3:44:45 AM","dateFinished":"Jun 5, 2017 3:44:45 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2387"},{"text":"%pyspark\n\ndef square(x):\n    return x * x\n    \nprint square(3)\n\n\nsquare2 = lambda e : e * e\nprint square2(3)\n\nadd2 = lambda a,b: a+ b\nprint add2(5,3)\n","dateUpdated":"Jun 5, 2017 3:50:43 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1496634238544_-450878270","id":"20170605-034358_1077586971","result":{"code":"SUCCESS","type":"TEXT","msg":"9\n9\n8\n"},"dateCreated":"Jun 5, 2017 3:43:58 AM","dateStarted":"Jun 5, 2017 3:50:43 AM","dateFinished":"Jun 5, 2017 3:50:43 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2388"},{"text":"%pyspark\ndata = [1,2,3,4]\nrDD = sc.parallelize(data, 4)\nrDD2 = rDD.map(lambda e : e * 2)\nrDD3 = rDD.filter(lambda e: e % 2 == 0)\nprint rDD3.collect()\n\n\nrDD4 = sc.parallelize([1,2,3,4,3,4,2,1], 4)\nrDD5 = rDD4.distinct()\nprint rDD5.collect()\n\n","dateUpdated":"Jun 5, 2017 3:59:33 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1496634524987_1208172667","id":"20170605-034844_923277177","result":{"code":"SUCCESS","type":"TEXT","msg":"[2, 4]\n[4, 1, 2, 3]\n"},"dateCreated":"Jun 5, 2017 3:48:44 AM","dateStarted":"Jun 5, 2017 3:59:33 AM","dateFinished":"Jun 5, 2017 3:59:34 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2389"},{"text":"%pyspark\n\nrdd=sc.parallelize([1,2,3])\nrdd2 = rdd.map(lambda e : [e, e+5])\nprint rdd2.collect()\n\nrdd3 = rdd.flatMap(lambda e : [e, e+5])\nprint rdd3.collect()","dateUpdated":"Jun 5, 2017 5:40:05 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1496634918729_-1472065913","id":"20170605-035518_814739823","result":{"code":"SUCCESS","type":"TEXT","msg":"[[1, 6], [2, 7], [3, 8]]\n[1, 6, 2, 7, 3, 8]\n"},"dateCreated":"Jun 5, 2017 3:55:18 AM","dateStarted":"Jun 5, 2017 5:40:05 AM","dateFinished":"Jun 5, 2017 5:40:06 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2390","focus":true},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1496641170253_984136531","id":"20170605-053930_73728309","dateCreated":"Jun 5, 2017 5:39:30 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2518","dateUpdated":"Jun 5, 2017 5:42:56 AM","dateFinished":"Jun 5, 2017 5:42:57 AM","dateStarted":"Jun 5, 2017 5:42:56 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"6\n[1, 2]\n[1, 2, 3]\n[5, 3, 2]\n"},"text":"%pyspark\n\nrdd=sc.parallelize([1,2,3])\nprint rdd.reduce(lambda a, b: a * b)\n\n\nprint rdd.take(2)\n\nprint rdd.collect()\n\n\nrdd=sc.parallelize([5,1,3,2])\nprint rdd.takeOrdered(3,lambda s:-1*s)\n"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1496641212934_-2137518475","id":"20170605-054012_268513577","dateCreated":"Jun 5, 2017 5:40:12 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2547","dateUpdated":"Jun 5, 2017 6:05:41 AM","dateFinished":"Jun 5, 2017 6:05:42 AM","dateStarted":"Jun 5, 2017 6:05:41 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"[(1, 2), (3, 10)]\n"},"text":"%pyspark\n\nrdd = sc.parallelize([(1,2), (3,4), (3,6)]) \nrdd2 = rdd.reduceByKey(lambda a, b: a + b)  \nprint rdd2.collect()\n\n"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1496641732261_1588340612","id":"20170605-054852_945929848","dateCreated":"Jun 5, 2017 5:48:52 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2585","dateUpdated":"Jun 5, 2017 5:53:14 AM","dateFinished":"Jun 5, 2017 5:53:15 AM","dateStarted":"Jun 5, 2017 5:53:14 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"[(1, 'a'), (1, 'b'), (2, 'c')]\n[(2, <pyspark.resultiterable.ResultIterable object at 0x17e69d0>), (1, <pyspark.resultiterable.ResultIterable object at 0x17e6310>)]\n"},"text":"%pyspark\nrdd2 = sc.parallelize([(1,'a'), (2,'c'), (1,'b')]) \nrdd3 =  rdd2.sortByKey()\nprint rdd3.collect()\n\nrdd4 = rdd2.groupByKey() \nprint rdd4.collect()\n\n"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1496641810787_-1145376944","id":"20170605-055010_960241148","dateCreated":"Jun 5, 2017 5:50:10 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2608","dateUpdated":"Jun 5, 2017 6:03:04 AM","dateFinished":"Jun 5, 2017 6:03:05 AM","dateStarted":"Jun 5, 2017 6:03:04 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"[1, 2, 3]\n"},"text":"%pyspark\n\n\nbroadcastVar = sc.broadcast([1, 2, 3]) \nprint broadcastVar.value\n"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1496642383859_-1447749064","id":"20170605-055943_336860026","dateCreated":"Jun 5, 2017 5:59:43 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2668","dateUpdated":"Jun 5, 2017 6:18:06 AM","dateFinished":"Jun 5, 2017 6:18:07 AM","dateStarted":"Jun 5, 2017 6:18:06 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"10\n"},"text":"%pyspark \naccum = sc.accumulator(0) \nrdd = sc.parallelize([1, 2, 3, 4]) \n\ndef f(x): \n  global accum\n  accum += x   \n\nrdd.foreach(f) \nprint accum.value\n\n\n"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1496642404173_-1929054614","id":"20170605-060004_2049701867","dateCreated":"Jun 5, 2017 6:00:04 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2689","dateUpdated":"Jun 5, 2017 6:12:54 AM","dateFinished":"Jun 5, 2017 6:12:57 AM","dateStarted":"Jun 5, 2017 6:12:54 AM","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>RDD 範例</h2>\n"},"text":"%md \n## RDD 範例"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1496643174684_-1873159875","id":"20170605-061254_2144050186","dateCreated":"Jun 5, 2017 6:12:54 AM","status":"ERROR","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3020","dateUpdated":"Jun 5, 2017 6:21:45 AM","dateFinished":"Jun 5, 2017 6:14:31 AM","dateStarted":"Jun 5, 2017 6:14:11 AM","result":{"code":"ERROR","type":"TEXT","msg":"Process exited with an error: 4 (Exit value: 4)"},"text":"%sh wget https://github.com/ywchiu/sparkcht/raw/master/Data/u.data"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1496645292544_1627994114","id":"20170605-064812_1923454095","dateCreated":"Jun 5, 2017 6:48:12 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3152","text":"%md\n### 分析使用者對電影的評價分數","dateUpdated":"Jun 5, 2017 6:48:38 AM","dateFinished":"Jun 5, 2017 6:48:38 AM","dateStarted":"Jun 5, 2017 6:48:38 AM","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>分析使用者對電影的評價分數</h3>\n"}},{"config":{"colWidth":11,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1496643251371_-956764616","id":"20170605-061411_2085411386","dateCreated":"Jun 5, 2017 6:14:11 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3044","dateUpdated":"Jun 5, 2017 6:47:48 AM","dateFinished":"Jun 5, 2017 6:47:49 AM","dateStarted":"Jun 5, 2017 6:47:48 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"[u'196\\t242\\t3\\t881250949', u'186\\t302\\t3\\t891717742']\n<class 'pyspark.rdd.PipelinedRDD'>\ndefaultdict(<type 'int'>, {u'1': 6110, u'3': 27145, u'2': 11370, u'5': 21201, u'4': 34174})\n<type 'collections.defaultdict'>\n1 6110\n2 11370\n3 27145\n4 34174\n5 21201\n"},"text":"%pyspark\nlines = sc.textFile(\"/tmp/u.data\")\nprint lines.take(2)\n\nratings = lines.map(lambda e : e.split()[2])\nprint type(ratings)\nresult = ratings.countByValue()\nprint result\nprint type(result)\n\nimport collections\nsortedResults = collections.OrderedDict(sorted(result.items()))\nfor key, value in sortedResults.iteritems():\n    print \"%s %i\" % (key, value)\n"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1496643459906_479193256","id":"20170605-061739_28707790","dateCreated":"Jun 5, 2017 6:17:39 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3068","dateUpdated":"Jun 5, 2017 6:43:12 AM","dateFinished":"Jun 5, 2017 6:43:12 AM","dateStarted":"Jun 5, 2017 6:43:12 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"3\n"},"text":"%pyspark \n\na = '196\\t242\\t3\\t881250949'\nprint(a.split()[2])"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1496644960101_-662230848","id":"20170605-064240_365660017","dateCreated":"Jun 5, 2017 6:42:40 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3116","dateUpdated":"Jun 5, 2017 6:51:36 AM","dateFinished":"Jun 5, 2017 6:51:36 AM","dateStarted":"Jun 5, 2017 6:51:36 AM","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>分析氣溫數據</h3>\n"},"text":"%md \n### 分析氣溫數據"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1496645481944_-1106371991","id":"20170605-065121_531933571","dateCreated":"Jun 5, 2017 6:51:21 AM","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3176","dateUpdated":"Jun 5, 2017 6:52:01 AM","text":"%sh wget https://github.com/ywchiu/sparkcht/raw/master/Data/1800.csv"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1496645517087_-1373525645","id":"20170605-065157_969859454","dateCreated":"Jun 5, 2017 6:51:57 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3204","text":"%pyspark \nlines = sc.textFile(\"/tmp/1800.csv\")\nprint lines.take(2)\n\n\ndef parseLine(line):\n    fields = line.split(',')\n    stationID = fields[0]\n    entryType = fields[2]\n    temperature = float(fields[3]) * 0.1 * (9.0 / 5.0) + 32.0\n    return (stationID, entryType, temperature)\n    \nparsedLines = lines.map(parseLine)\nprint parsedLines.take(2)\n\nminTemps = parsedLines.filter(lambda e: 'TMIN' in e[1])\nprint minTemps.take(2)\n\n\nstationTemps = minTemps.map(lambda e: (e[0], e[2]) )\nprint stationTemps.take(2)\n\nminTemps = stationTemps.reduceByKey(lambda x, y: min(x,y))\nprint minTemps.take(2)\n\nresults = minTemps.collect()\n\nfor result in results:\n    print result[0], result[1]\n\n","dateUpdated":"Jun 5, 2017 7:07:09 AM","dateFinished":"Jun 5, 2017 7:06:52 AM","dateStarted":"Jun 5, 2017 7:06:51 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"[u'ITE00100554,18000101,TMAX,-75,,,E,', u'ITE00100554,18000101,TMIN,-148,,,E,']\n[(u'ITE00100554', u'TMAX', 18.5), (u'ITE00100554', u'TMIN', 5.3599999999999994)]\n[(u'ITE00100554', u'TMIN', 5.3599999999999994), (u'EZE00100082', u'TMIN', 7.6999999999999993)]\n[(u'ITE00100554', 5.3599999999999994), (u'EZE00100082', 7.6999999999999993)]\n[(u'ITE00100554', 5.3599999999999994), (u'EZE00100082', 7.6999999999999993)]\nITE00100554 5.36\nEZE00100082 7.7\n"}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1496645587078_-1034253736","id":"20170605-065307_1911584279","dateCreated":"Jun 5, 2017 6:53:07 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3227","dateUpdated":"Jun 5, 2017 7:02:48 AM","dateFinished":"Jun 5, 2017 7:02:48 AM","dateStarted":"Jun 5, 2017 7:02:48 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"True\n1\n"},"text":"%pyspark\n\na = 'this is an apple'\nprint 'apple' in a\n\n\n\nb = [('T1', 3), ('T1', 1), ('T1', 5)]\nminTemps = 100\nfor rec in b:\n    if rec[1] < minTemps:\n        minTemps = rec[1]\nprint minTemps\n"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1496647289618_1799825798","id":"20170605-072129_1005713876","dateCreated":"Jun 5, 2017 7:21:29 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3387","text":"%md \n### 使用PySpark 做 WordCount","dateUpdated":"Jun 5, 2017 7:21:49 AM","dateFinished":"Jun 5, 2017 7:21:49 AM","dateStarted":"Jun 5, 2017 7:21:49 AM","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>使用PySpark 做 WordCount</h3>\n"}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1496645889146_1342384547","id":"20170605-065809_1953324433","dateCreated":"Jun 5, 2017 6:58:09 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3250","dateUpdated":"Jun 5, 2017 7:23:55 AM","dateFinished":"Jun 5, 2017 7:23:55 AM","dateStarted":"Jun 5, 2017 7:23:55 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"THE 206\nTO 168\nA 112\nAND 112\nOF 106\nIN 104\nHE 87\nH-1B 65\nIS 53\nFOR 51\nHIS 50\nI 45\nWAS 44\nTHAT 36\nARE 35\nWITH 33\nAN 32\nAS 31\nIT 30\nBUT 28\nWORKERS 28\nON 28\nAT 27\nNOT 26\nMY 24\nTHEY 24\nAMERICAN 23\nDIANGELO 22\nBY 22\nWHO 21\n"},"text":"%pyspark \ninput = sc.textFile(\"/tmp/cnn.txt\")\nwords = input.map(lambda e: e.upper())\nsegment = words.flatMap(lambda e: e.split())\n#print segment.take(100)\n\nwordCounts = segment.countByValue()\n\nfrom operator import itemgetter\nswd = sorted (wordCounts.items(), key =itemgetter(1), reverse=True)\n\nfor key, value in swd[0:30]:\n    print \"%s %i\" % (key, value)\n"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1496646748789_-1345665549","id":"20170605-071228_227955052","dateCreated":"Jun 5, 2017 7:12:28 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3302","dateUpdated":"Jun 5, 2017 7:13:55 AM","dateFinished":"Jun 5, 2017 7:13:55 AM","dateStarted":"Jun 5, 2017 7:13:55 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"THIS IS MY COMPUTER\n"},"text":"%pyspark\n\na = 'this is my computer'\nprint a.upper()"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1496648853135_-729864282","id":"20170605-074733_932957974","dateCreated":"Jun 5, 2017 7:47:33 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3494","text":"%md\n\n### 中文分詞","dateUpdated":"Jun 5, 2017 7:47:47 AM","dateFinished":"Jun 5, 2017 7:47:47 AM","dateStarted":"Jun 5, 2017 7:47:47 AM","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>中文分詞</h3>\n"}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1496646835689_1904631862","id":"20170605-071355_1500802402","dateCreated":"Jun 5, 2017 7:13:55 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3323","dateUpdated":"Jun 5, 2017 7:55:24 AM","dateFinished":"Jun 5, 2017 7:54:51 AM","dateStarted":"Jun 5, 2017 7:54:50 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"今天\n天氣\n真好\n[u'0,tcp,http,SF,181,5450,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,8,8,0.00,0.00,0.00,0.00,1.00,0.00,0.00,9,9,1.00,0.00,0.11,0.00,0.00,0.00,0.00,0.00,normal.', u'0,tcp,http,SF,239,486,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,8,8,0.00,0.00,0.00,0.00,1.00,0.00,0.00,19,19,1.00,0.00,0.05,0.00,0.00,0.00,0.00,0.00,normal.']\n"},"text":"%pyspark\nimport jieba\nfor ele in jieba.cut('今天天氣真好'):\n    print ele\n"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1496648384253_-273056780","id":"20170605-073944_2049996954","dateCreated":"Jun 5, 2017 7:39:44 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3415","dateUpdated":"Jun 5, 2017 7:47:13 AM","dateFinished":"Jun 5, 2017 7:46:28 AM","dateStarted":"Jun 5, 2017 7:46:27 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"坍方 3\n中元 3\n市府 3\n方便 3\n生活 3\n工程 2\n居民 2\n住戶 2\n活動 2\n主普壇 2\n工期 2\n淹水 2\n基隆 2\n進出 2\n山路 2\n表示 1\n一切 1\n開工 1\n出入 1\n"},"text":"%pyspark \nimport jieba\ninput = sc.textFile(\"/tmp/chinese_news.txt\")\nseg = input.flatMap(lambda e : ' '.join(jieba.cut(e)).split())\nwordCounts = seg.countByValue()\n\nfrom operator import itemgetter\nswd = sorted (wordCounts.items(), key =itemgetter(1), reverse=True)\n\nfor key, value in swd[0:30]:\n    if len(key) >=2:\n        print \"%s %i\" % (key, value)\n"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1496648427708_220853539","id":"20170605-074027_155913464","dateCreated":"Jun 5, 2017 7:40:27 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3438","dateUpdated":"Jun 5, 2017 7:50:04 AM","dateFinished":"Jun 5, 2017 7:50:04 AM","dateStarted":"Jun 5, 2017 7:50:04 AM","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>網路入侵分析</h3>\n"},"text":"%md\n\n### 網路入侵分析"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1496649021165_-23987968","id":"20170605-075021_574927646","dateCreated":"Jun 5, 2017 7:50:21 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3536","dateUpdated":"Jun 5, 2017 7:57:55 AM","dateFinished":"Jun 5, 2017 7:57:59 AM","dateStarted":"Jun 5, 2017 7:57:55 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"[u'0,tcp,http,SF,181,5450,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,8,8,0.00,0.00,0.00,0.00,1.00,0.00,0.00,9,9,1.00,0.00,0.11,0.00,0.00,0.00,0.00,0.00,normal.', u'0,tcp,http,SF,239,486,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,8,8,0.00,0.00,0.00,0.00,1.00,0.00,0.00,19,19,1.00,0.00,0.05,0.00,0.00,0.00,0.00,0.00,normal.']\n<class 'pyspark.rdd.PipelinedRDD'>\n49493\n494021\n"},"text":"%pyspark\nraw_data = sc.textFile(\"/tmp/kddcup.data_10_percent.gz\")\nprint raw_data.take(2)\n\n\nraw_data_sample = raw_data.sample(False, 0.1, 1234)\n\nprint type(raw_data_sample)\n\nprint raw_data_sample.count()\nprint raw_data.count()\n"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1496649185168_-1675316568","id":"20170605-075305_593865625","dateCreated":"Jun 5, 2017 7:53:05 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3569","dateUpdated":"Jun 5, 2017 7:59:42 AM","dateFinished":"Jun 5, 2017 7:59:42 AM","dateStarted":"Jun 5, 2017 7:59:42 AM","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>分析朋友數量</h3>\n"},"text":"%md\n\n### 分析朋友數量"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1496649582100_-426468731","id":"20170605-075942_1230351038","dateCreated":"Jun 5, 2017 7:59:42 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3615","dateUpdated":"Jun 5, 2017 8:08:27 AM","dateFinished":"Jun 5, 2017 8:08:28 AM","dateStarted":"Jun 5, 2017 8:08:27 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"[u'0,Will,33,385', u'1,Jean-Luc,26,2']\n[(33, 385), (26, 2)]\n[(33, (385, 1)), (26, (2, 1)), (55, (221, 1))]\n[(18, (2747, 8)), (20, (825, 5)), (22, (1445, 7))]\n[(18, 343), (20, 165), (22, 206)]\n(18, 343)\n(20, 165)\n(22, 206)\n(24, 233)\n(26, 242)\n(28, 209)\n(30, 235)\n(32, 207)\n(34, 245)\n(36, 246)\n"},"text":"%pyspark\nlines = sc.textFile('/tmp/fakefriends.csv')\nprint lines.take(2)\n\ndef parseLine(line):\n    fields = line.split(',')\n    age = int(fields[2])\n    numFriends = int(fields[3])\n    return (age, numFriends)\n    \n    \nrdd = lines.map(parseLine)\nprint rdd.take(2)\n\n\nrdd2 = rdd.mapValues(lambda x: (x, 1))\nprint rdd2.take(3)\n\n\ntotalsByAge = rdd2.reduceByKey(lambda x, y: (x[0] + y[0], x[1] + y[1]))\nprint totalsByAge.take(3)\n\n\naveragesByAge = totalsByAge.mapValues(lambda x: x[0] / x[1])\nprint averagesByAge.take(3)\n\nresults = averagesByAge.collect()\nfor result in results[0:10]:\n    print result\n\n\n"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1496649698561_1550941401","id":"20170605-080138_998999396","dateCreated":"Jun 5, 2017 8:01:38 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3641","dateUpdated":"Jun 5, 2017 8:10:19 AM","dateFinished":"Jun 5, 2017 8:10:19 AM","dateStarted":"Jun 5, 2017 8:10:19 AM","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>分析顧客消費資料</h3>\n"},"text":"%md\n### 分析顧客消費資料"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1496650219149_-1308023696","id":"20170605-081019_1328829271","dateCreated":"Jun 5, 2017 8:10:19 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3688","dateUpdated":"Jun 5, 2017 8:13:58 AM","dateFinished":"Jun 5, 2017 8:13:58 AM","dateStarted":"Jun 5, 2017 8:13:58 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"[u'44,8602,37.19', u'35,5368,65.89']\n[(44, 37.189999999999998), (35, 65.890000000000001), (2, 40.640000000000001)]\n[(0, 5524.9499999999989), (2, 5994.5900000000001), (4, 4815.0500000000011)]\n(0, 5524.9499999999989)\n(2, 5994.5900000000001)\n(4, 4815.0500000000011)\n(6, 5397.8799999999992)\n(8, 5517.2399999999998)\n(10, 4819.6999999999998)\n(12, 4664.5899999999992)\n(14, 4735.0300000000007)\n(16, 4979.0600000000004)\n(18, 4921.2699999999986)\n"},"text":"%pyspark\nlines = sc.textFile('/tmp/customer-orders.csv')\nprint lines.take(2)\n\n\n\ndef extractCustomerPricePairs(line):\n    fields = line.split(',')\n    return (int(fields[0]), float(fields[2]))\n    \n    \nmappedInput =  lines.map(extractCustomerPricePairs)\n\nprint mappedInput.take(3)\n\n\ntotalByCustomer = mappedInput.reduceByKey(lambda x, y: x + y)\nprint totalByCustomer.take(3)\n\n\nresults = totalByCustomer.collect()\nfor result in results[0:10]:\n    print result\n\n\n"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1496650251512_-1972238215","id":"20170605-081051_687286145","dateCreated":"Jun 5, 2017 8:10:51 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3714","dateUpdated":"Jun 5, 2017 8:15:46 AM","dateFinished":"Jun 5, 2017 8:15:46 AM","dateStarted":"Jun 5, 2017 8:15:46 AM","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>找出最受歡迎的電影</h3>\n"},"text":"%md\n### 找出最受歡迎的電影"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1496650513643_-335336316","id":"20170605-081513_1225664893","dateCreated":"Jun 5, 2017 8:15:13 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3753","dateUpdated":"Jun 5, 2017 8:36:42 AM","dateFinished":"Jun 5, 2017 8:35:48 AM","dateStarted":"Jun 5, 2017 8:35:46 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"[u'196\\t242\\t3\\t881250949', u'186\\t302\\t3\\t891717742']\n[(u'1269', 10), (u'1524', 8), (u'669', 13)]\n[(10, u'1269'), (8, u'1524'), (13, u'669')]\n(583, u'50')\n(509, u'258')\n(508, u'100')\n(507, u'181')\n(485, u'294')\n(481, u'286')\n(478, u'288')\n(452, u'1')\n(431, u'300')\n(u'Star Wars (1977)', 583)\n(u'Contact (1997)', 509)\n(u'Fargo (1996)', 508)\n(u'Return of the Jedi (1983)', 507)\n(u'Liar Liar (1997)', 485)\n(u'English Patient, The (1996)', 481)\n(u'Scream (1996)', 478)\n(u'Toy Story (1995)', 452)\n(u'Air Force One (1997)', 431)\n"},"text":"%pyspark\nlines = sc.textFile('/tmp/u.data')\nprint lines.take(2)\n\ndef parseLine(line):\n    lines = line.split()\n    return (lines[1], 1)\n\nmovies = lines.map(parseLine)\nmovieCount = movies.reduceByKey(lambda x,y:x+y)\nprint movieCount.take(3)\n\nflipped = movieCount.map(lambda (x,y): (y,x))\nprint flipped.take(3)\n\n\nsortedMovies = flipped.sortByKey()\nresults = sortedMovies.collect()\nfor result in results[:-10:-1]:\n    print result\n\n\n\n## Load Move Names\nitems = sc.textFile('/tmp/u.item')\nresults = items.collect()\n\ndef loadMovieNames():\n    movieNames = {}\n    for ele in results:\n        rec = ele.split('|')\n        movieNames[int(rec[0])] = rec[1]\n    return movieNames\n\nmovieDic = loadMovieNames()\n#print movieDic\n\nnameDict = sc.broadcast(movieDic)\n\n\nsortedMoviesWithNames = sortedMovies.map(lambda (count, movie) : (nameDict.value[int(movie)], count))\nresults = sortedMoviesWithNames.collect()\n#print results\nfor res in results[:-10:-1]:\n    print res\n"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1496650586904_541814555","id":"20170605-081626_789581168","dateCreated":"Jun 5, 2017 8:16:26 AM","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3779"}],"name":"Demo20170605","id":"2CMPERDTE","angularObjects":{"2CKPTPBHQ":[],"2CHACSURV":[],"2CJ7N8C1Q":[],"2CJMA46YQ":[],"2CHJTBEC6":[],"2CKFJ7ASR":[],"2CJFU8FRW":[],"2CK3PEWZY":[],"2CK6J3R4P":[],"2CHJUY4HV":[],"2CKEK5S5E":[],"2CKG5FHPJ":[],"2CH9HR8XV":[]},"config":{"looknfeel":"default"},"info":{}}