{"paragraphs":[{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1496713382628_-1895956709","id":"20170606-014302_1363017857","dateCreated":"Jun 6, 2017 1:43:02 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:615","text":"%pyspark\n\nfrom pyspark.sql import SQLContext\nsqlContext = SQLContext(sc)\nprint type(sqlContext)\n\n# Read Data From HDFS\ndata_file = \"/tmp/ratings.txt\"\nraw_data = sc.textFile(data_file)\n\nprint type(raw_data)\n\n\nprint raw_data.take(3)\n\nprint raw_data.first()\n\nheader = raw_data.first()\nskip_data = raw_data.filter(lambda line: line != header)\n\nprint skip_data.take(2)\n\ncsv_data = skip_data.map(lambda l: l.split(\"::\"))\nprint csv_data.take(2)\n\nfrom pyspark.sql import Row\nrow_data = csv_data.map(lambda p: Row(\n    userid=p[0], \n    itemid=p[1],\n    rating=int(p[2])\n    )\n)\n\nprint row_data.take(2)\n\n\ndf = sqlContext.createDataFrame(row_data)\nprint df\n\nprint df.take(5)\n\n\ndf.show(5)\n","dateUpdated":"Jun 6, 2017 2:05:06 AM","dateFinished":"Jun 6, 2017 2:05:07 AM","dateStarted":"Jun 6, 2017 2:05:06 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"<class 'pyspark.sql.context.SQLContext'>\n<class 'pyspark.rdd.RDD'>\n[u'userid::itemid::rating', u'0::0::4', u'0::1::5']\nuserid::itemid::rating\n[u'0::0::4', u'0::1::5']\n[[u'0', u'0', u'4'], [u'0', u'1', u'5']]\n[Row(itemid=u'0', rating=4, userid=u'0'), Row(itemid=u'1', rating=5, userid=u'0')]\nDataFrame[itemid: string, rating: bigint, userid: string]\n[Row(itemid=u'0', rating=4, userid=u'0'), Row(itemid=u'1', rating=5, userid=u'0'), Row(itemid=u'7495', rating=3, userid=u'0'), Row(itemid=u'7496', rating=5, userid=u'0'), Row(itemid=u'7497', rating=5, userid=u'0')]\n+------+------+------+\n|itemid|rating|userid|\n+------+------+------+\n|     0|     4|     0|\n|     1|     5|     0|\n|  7495|     3|     0|\n|  7496|     5|     0|\n|  7497|     5|     0|\n+------+------+------+\nonly showing top 5 rows\n\n"},"focus":true},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1496713393060_158232992","id":"20170606-014313_2096065011","dateCreated":"Jun 6, 2017 1:43:13 AM","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:634"}],"name":"Demo20170606","id":"2CM2RHXGB","angularObjects":{"2CKPTPBHQ":[],"2CHACSURV":[],"2CJ7N8C1Q":[],"2CJMA46YQ":[],"2CHJTBEC6":[],"2CKFJ7ASR":[],"2CJFU8FRW":[],"2CK3PEWZY":[],"2CK6J3R4P":[],"2CHJUY4HV":[],"2CKEK5S5E":[],"2CKG5FHPJ":[],"2CH9HR8XV":[]},"config":{"looknfeel":"default"},"info":{}}